---
import BaseLayout from "../../layouts/BaseLayout.astro";
import PageHeader from "../../components/PageHeader.astro";
import FestivityCard from "../../components/FestivityCard.astro";
import { fetchFestivities } from "../../lib/api";

const festivities = await fetchFestivities();

// Sort by date
const sortedFestivities = [...festivities].sort(
  (a, b) => new Date(a.start_date).getTime() - new Date(b.start_date).getTime()
);
---

<BaseLayout
  title="Festividades y Celebraciones Tradicionales"
  description="Calendario de festividades y fiestas costumbristas en Mar铆a Parado de Bellido, Ayacucho. Descubre nuestras celebraciones patronales, cargontes y tradiciones andinas."
  image="/images/hero-festivities.webp"
>
  <PageHeader
    title="Festividades y Celebraciones"
    subtitle="La fe y la tradici贸n se encuentran en nuestras fiestas"
    icon=""
    variant="gradient"
  />

  <section class="container-custom py-16 md:py-20">
    <div class="max-w-4xl mx-auto text-center reveal mb-12">
      <h2 class="section-heading">Calendario Festivo</h2>
      <p class="text-evocative mb-4">
        Las festividades de Mar铆a Parado de Bellido son expresiones vivas de
        nuestra fe cat贸lica entrelazada con creencias ancestrales andinas. Cada
        celebraci贸n es organizada por los cargontes, familias que con devoci贸n y
        sacrificio asumen la responsabilidad de honrar a nuestros santos
        patronos.
      </p>
      <p class="text-evocative">
        Procesiones, danzas tradicionales, misas solemnes y comida comunitaria
        se unen en una explosi贸n de color, m煤sica y espiritualidad que convoca a
        toda la comunidad.
      </p>
    </div>

    {
      sortedFestivities.length > 0 ? (
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {sortedFestivities.map((festivity) => (
            <div class="reveal">
              <FestivityCard festivity={festivity} />
            </div>
          ))}
        </div>
      ) : (
        <div class="text-center py-16">
          <p class="text-gray-600 mb-4">
            No hay festividades programadas en este momento. Consulta
            pr贸ximamente o cont谩ctanos para m谩s informaci贸n.
          </p>
          <a href="/contact" class="btn-primary">
            Cont谩ctanos
          </a>
        </div>
      )
    }
  </section>

  <section
    class="bg-gradient-to-br from-indigo to-indigo-dark text-white py-16 md:py-20 pattern-overlay"
  >
    <div class="container-custom">
      <div class="max-w-4xl mx-auto text-center reveal">
        <h2 class="text-3xl md:text-4xl font-heading font-bold mb-6">
          El Sistema de Cargontes
        </h2>
        <p class="text-lg mb-6 text-white/90 leading-relaxed">
          Los cargontes son el coraz贸n de nuestras festividades. Familias
          enteras asumen el cargo de organizar las celebraciones: financian la
          banda de m煤sica, preparan la comida para cientos de personas, adornan
          la iglesia y coordinan las procesiones. Es un acto de fe, generosidad
          y servicio comunitario que fortalece nuestros lazos sociales y
          espirituales.
        </p>
        <p class="text-lg text-white/90">
          Ser cargonte es un honor que se transmite con orgullo y que deja una
          huella imborrable en la memoria colectiva del distrito.
        </p>
      </div>
    </div>
  </section>
</BaseLayout>
